<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>使用aardio制作一个简单的httpserver工具网页版 | 蓝香川个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="aardio是一个好工具，平时我用它做了几个小工具自己用。今天看到一个不错的案例，是用layui和simplehttpserver写的一个网页版共享工具。感觉很不错，就记录下来。 原作者网址：https:&#x2F;&#x2F;aardio.online&#x2F;thread-140.htm 原代码如下： 123456789101112131415161718192021222324252627282930313233343">
<meta property="og:type" content="article">
<meta property="og:title" content="使用aardio制作一个简单的httpserver工具网页版">
<meta property="og:url" content="https://zhuzhuhawk.github.io/2024/12/25/use-aardio-make-a-simplehttpserver-tool/index.html">
<meta property="og:site_name" content="蓝香川个人博客">
<meta property="og:description" content="aardio是一个好工具，平时我用它做了几个小工具自己用。今天看到一个不错的案例，是用layui和simplehttpserver写的一个网页版共享工具。感觉很不错，就记录下来。 原作者网址：https:&#x2F;&#x2F;aardio.online&#x2F;thread-140.htm 原代码如下： 123456789101112131415161718192021222324252627282930313233343">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-12-25T02:36:50.000Z">
<meta property="article:modified_time" content="2024-12-25T02:46:34.183Z">
<meta property="article:author" content="小蓝">
<meta property="article:tag" content="aardio">
<meta property="article:tag" content="web">
<meta property="article:tag" content="httpserver">
<meta property="article:tag" content="webtool">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="蓝香川个人博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">蓝香川个人博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">记录生活的点点滴滴</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">首页</a>
        
          <a class="main-nav-link" href="/archives">归档</a>
        
          <a class="main-nav-link" href="/categories">分类</a>
        
          <a class="main-nav-link" href="/about">关于</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS 订阅"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="搜索"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://zhuzhuhawk.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-use-aardio-make-a-simplehttpserver-tool" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/12/25/use-aardio-make-a-simplehttpserver-tool/" class="article-date">
  <time class="dt-published" datetime="2024-12-25T02:36:50.000Z" itemprop="datePublished">2024-12-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      使用aardio制作一个简单的httpserver工具网页版
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>aardio是一个好工具，平时我用它做了几个小工具自己用。<br>今天看到一个不错的案例，是用layui和simplehttpserver写的一个网页版共享工具。<br>感觉很不错，就记录下来。</p>
<p>原作者网址：<code>https://aardio.online/thread-140.htm</code></p>
<p>原代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br></pre></td><td class="code"><pre><span class="line">import win.ui;</span><br><span class="line">/*DSG&#123;&#123;*/</span><br><span class="line">winform = win.form(text=&quot;简易WEB文件服务器&quot;;right=570;bottom=183;border=&quot;dialog frame&quot;;max=false)</span><br><span class="line">winform.add(</span><br><span class="line">btnOpenFolder=&#123;cls=&quot;button&quot;;text=&quot;...&quot;;left=491;top=46;right=531;bottom=78;z=5&#125;;</span><br><span class="line">btnStart=&#123;cls=&quot;button&quot;;text=&quot;启动服务器&quot;;left=44;top=100;right=193;bottom=142;font=LOGFONT(h=-13);z=1&#125;;</span><br><span class="line">edit=&#123;cls=&quot;edit&quot;;left=107;top=46;right=483;bottom=77;dl=1;dr=1;dt=1;edge=1;z=2&#125;;</span><br><span class="line">static1=&#123;cls=&quot;static&quot;;text=&quot;共享目录：&quot;;left=35;top=46;right=107;bottom=78;center=1;font=LOGFONT(h=-13);transparent=1;z=3&#125;;</span><br><span class="line">weblink=&#123;cls=&quot;syslink&quot;;text=&quot;网站未运行&quot;;left=214;top=115;right=518;bottom=139;dr=1;dt=1;transparent=1;z=4&#125;</span><br><span class="line">)</span><br><span class="line">/*&#125;&#125;*/</span><br><span class="line"></span><br><span class="line">import gdip.bitmap;</span><br><span class="line">import win.image;  </span><br><span class="line">import fsys.stream;    //上面三个库主要用于保存favicon.ico</span><br><span class="line">import fsys;</span><br><span class="line">import fsys.info;     //用来获取文件图标</span><br><span class="line">import fsys.dlg.dir;</span><br><span class="line">import  inet.http;</span><br><span class="line"></span><br><span class="line">//配置网页及网页标题等信息</span><br><span class="line">winform.root = io._exedir;</span><br><span class="line">winform.title = &quot;在线文件管理系统&quot;;</span><br><span class="line">winform.admin = &quot;Mr_MAO&quot;;</span><br><span class="line">winform.html = inet.http.get(&quot;https://aardio.online/attach-download-145.htm&quot;);//加载附件&quot;web.html&quot;</span><br><span class="line"></span><br><span class="line">//配置服务器</span><br><span class="line">import wsock.tcp.simpleHttpServer;</span><br><span class="line">namespace wsock.tcp.simpleHttpServer&#123;</span><br><span class="line">    startIp = &quot;0.0.0.0&quot;;</span><br><span class="line">    //startPort = 8080;    </span><br><span class="line">    threadGlobal = &#123; winform = ..winform &#125;;</span><br><span class="line">    documentRoot = ..winform.root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//获取文件图标，生成缩略图</span><br><span class="line">winform.getfileIcon = function(path)&#123; </span><br><span class="line">    var sfi = fsys.info.get(path, 0x100/*_SHGFI_ICON*/ | 0x4000/*_SHGFI_SYSICONINDEX*/);</span><br><span class="line">    var bmp = ..gdip.bitmap(sfi.hIcon,1/*_IMAGE_ICON*/);     </span><br><span class="line">    if(sfi.hIcon)::DestroyIcon(sfi.hIcon);    </span><br><span class="line">    if(bmp) return bmp.saveToBuffer(&quot;.png&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">winform.btnStart.oncommand = function(id,event)&#123;</span><br><span class="line">  if(string.trim(owner.text)==&quot;启动服务器&quot;)&#123;</span><br><span class="line">    if(winform.edit.text==&quot;&quot;) winform.edit.text = winform.root;</span><br><span class="line">    //检查 favicon.ico</span><br><span class="line">    if(not io.exist(winform.root + &quot;favicon.ico&quot;))&#123;</span><br><span class="line">        var hIcon = win.image.extractIcon(io._exepath,,false)  </span><br><span class="line">        var bmp = gdip.bitmap(hIcon,1);</span><br><span class="line">        var stream = fsys.stream()</span><br><span class="line">        bmp.saveToStream(stream, &quot;*.png&quot;)</span><br><span class="line">        string.save(winform.root + &quot;/favicon.ico&quot;, stream.readAll() )    </span><br><span class="line">        ::DestroyIcon(hIcon) </span><br><span class="line">    &#125;    </span><br><span class="line">    //检查 logo.png</span><br><span class="line">    if(not io.exist(winform.root +&quot;logo.png&quot;))&#123;</span><br><span class="line">        var hIcon = win.image.extractIcon(io._exepath,,false)  </span><br><span class="line">        var bmp = gdip.bitmap(hIcon,1);</span><br><span class="line">        bmp.save(winform.root +&quot;logo.png&quot;)</span><br><span class="line">        ::DestroyIcon(hIcon)</span><br><span class="line">    &#125;    </span><br><span class="line">    </span><br><span class="line">    //检查 回收站文件夹</span><br><span class="line">    var recyclefolder = winform.root + &quot;回收站&quot;</span><br><span class="line">        if(!io.exist(recyclefolder))&#123;</span><br><span class="line">        fsys.createDir(recyclefolder)</span><br><span class="line">        fsys.attrib(recyclefolder,,2/*_FILE_ATTRIBUTE_HIDDEN*/)</span><br><span class="line">        &#125;    </span><br><span class="line"></span><br><span class="line">    //启动simpleHttpServer服务器</span><br><span class="line">    url = wsock.tcp.simpleHttpServer.startUrl(</span><br><span class="line">        function(response,request,session)&#123; </span><br><span class="line">        import fsys;</span><br><span class="line">        import web.json;</span><br><span class="line">        import thread.table; //线程表</span><br><span class="line">            </span><br><span class="line">            //主页   </span><br><span class="line">            if(request.path == &quot;/main.aardio&quot;)&#123;</span><br><span class="line">                var path = request.query(&quot;folderpath&quot;)</span><br><span class="line">                if(!path || path==&quot;/&quot;)&#123; //主页请求</span><br><span class="line">                    html = string.loadcode(winform.html, </span><br><span class="line">                    //利用模板语法初始化其它一些网站参数</span><br><span class="line">                    &#123;title=winform.title;admin=winform.admin;nav=&quot;&lt;a&gt;&lt;cite&gt;根目录&lt;/cite&gt;&lt;/a&gt;&quot;;currDir=&quot;/&quot;;table_url=&quot;/&quot;&#125;)</span><br><span class="line">                &#125;else &#123;  //面包屑请求</span><br><span class="line">                    //将url参数分解为数组，并组装为breadcrumb路径</span><br><span class="line">                    path=string.trimright(path,&#x27;/&#x27;) </span><br><span class="line">                    var tab  = string.split(path,&#x27;/&#x27;)</span><br><span class="line">                    var temp = &quot;&quot;</span><br><span class="line">                    var breadcrumb_str=&quot;&quot;</span><br><span class="line">                    for(k,v in tab)&#123;</span><br><span class="line">            temp += v +&quot;/&quot;</span><br><span class="line">            if(k&lt;#tab)&#123;</span><br><span class="line">                if(v==&quot;&quot;)&#123;</span><br><span class="line">                        v=&quot;根目录&quot;;</span><br><span class="line">                breadcrumb_str += &quot;&lt;a href=&#x27;/&#x27;&gt;&quot; + v + &quot;&lt;/a&gt;&quot;;</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                breadcrumb_str += &quot;&lt;a href=&#x27;/?folderpath=&quot; + temp + &quot;&#x27;&gt;&quot; + v + &quot;&lt;/a&gt;&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;else &#123;</span><br><span class="line">                breadcrumb_str += &quot;&lt;a&gt;&lt;cite&gt;&quot;+ v + &quot;&lt;/cite&gt;&lt;/a&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;</span><br><span class="line">                    html = string.loadcode(winform.html, </span><br><span class="line">                    &#123;title=winform.title;admin=winform.admin;nav=breadcrumb_str;currDir=path;table_url=path&#125;)</span><br><span class="line">                &#125;    </span><br><span class="line">                response.contentType = &quot;text/html&quot;;</span><br><span class="line">                response.write(html)</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            //返回指定目录内的文件列表</span><br><span class="line">            if(request.path == &quot;/getfolder&quot;)&#123;     </span><br><span class="line">                var path = request.query(&quot;folderpath&quot;)</span><br><span class="line">                var serverPath = io.joinpath(request.documentRoot, path)</span><br><span class="line"></span><br><span class="line">                //检索对应的本地目录</span><br><span class="line">                if( fsys.isDir(serverPath) )&#123;</span><br><span class="line">                    var templist = &#123;&#125;</span><br><span class="line">                    fsys.enum( serverPath, &quot;*.*&quot;,</span><br><span class="line">                        function(dir,filename,fullpath,findData)&#123; </span><br><span class="line">                            if(findData.dwFileAttributes &amp; 2/*_FILE_ATTRIBUTE_HIDDEN*/) return; //不显示隐藏目录&amp;文件</span><br><span class="line">                            if(filename)&#123;    //文件</span><br><span class="line">                                var size = math.size64(findData.nFileSizeLow,findData.nFileSizeHigh).format()</span><br><span class="line">                                var mdftime =  tostring(fsys.fromFileTime(findData.ftLastWriteTime),&quot;%Y-%m-%d %H:%M:%S&quot;);//utc时间</span><br><span class="line">                                var webPath = string.right(fullpath,-#request.documentRoot)</span><br><span class="line">                                webPath = string.replace(webPath,&quot;@\&quot;,&quot;/&quot;)</span><br><span class="line">                                table.push(templist,</span><br><span class="line">                                    &#123;[&quot;name&quot;]=filename,[&quot;size&quot;]=size,[&quot;time&quot;]=mdftime;[&quot;path&quot;]=webPath;[&quot;type&quot;]=0&#125;) //设定type=0为文件</span><br><span class="line">                            &#125;else&#123;    //目录    </span><br><span class="line">                                var mdftime =  tostring(fsys.fromFileTime(findData.ftLastWriteTime),&quot;%Y-%m-%d %H:%M:%S&quot;);    </span><br><span class="line">                                var webPath = string.right(fullpath,-#request.documentRoot)</span><br><span class="line">                                webPath = string.replace(webPath,&quot;@\&quot;,&quot;/&quot;)</span><br><span class="line">                                table.push(templist,</span><br><span class="line">                                    &#123;[&quot;name&quot;]=dir,[&quot;size&quot;]=&quot;/&quot;,[&quot;time&quot;]=mdftime;[&quot;path&quot;]=webPath;[&quot;type&quot;]=1&#125;) //设定type=1为目录</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; </span><br><span class="line">                        ,0/*不包括子目录*/</span><br><span class="line">                    );</span><br><span class="line">                    var retlist = &#123;&#125;</span><br><span class="line">                    if(#templist&gt;0)&#123;</span><br><span class="line">                        retlist = table.mix(&#123;&#125;,&#123;&quot;code&quot;=0; &quot;msg&quot;=&quot;success&quot;;  &quot;count&quot;=#templist; &quot;data&quot;=templist&#125; )</span><br><span class="line">                    &#125;else&#123;</span><br><span class="line">                        retlist = &#123;&quot;code&quot;=1; &quot;msg&quot;=&quot;该目录为空&quot;;&#125;  //空目录</span><br><span class="line">                    &#125;</span><br><span class="line">                    //返回json</span><br><span class="line">                    var json = web.json.stringify(retlist,true)</span><br><span class="line">                    response.contentType = &quot;text/json&quot;</span><br><span class="line">                    response.write(json)</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    response.contentType = &quot;text/json&quot;</span><br><span class="line">                    var retJson = &#x27;&#123; &quot;code&quot;: 1, &quot;msg&quot;: &quot;错误,找不到你指定的目录&quot;&#125;&#x27;</span><br><span class="line">                    response.write(retJson)</span><br><span class="line">                &#125;</span><br><span class="line">                return;</span><br><span class="line">            &#125;    </span><br><span class="line">             </span><br><span class="line">            //返回缩略图</span><br><span class="line">            if(string.startWith(request.path,&quot;/thumbnail&quot;,true) )&#123;    </span><br><span class="line">                var path = string.right(request.path,-#&quot;/thumbnail/&quot;)</span><br><span class="line">                var serverPath = io.joinpath(request.documentRoot, path)</span><br><span class="line">                </span><br><span class="line">                if(io.exist(serverPath))&#123;</span><br><span class="line">                    if(fsys.isDir(serverPath))&#123;</span><br><span class="line">                        if(!thread.table(&quot;iconlist&quot;)[&quot;folder&quot;])&#123;</span><br><span class="line">                            thread.table(&quot;iconlist&quot;)[&quot;folder&quot;] = winform.getfileIcon(io._exedir)</span><br><span class="line">                        &#125;</span><br><span class="line">                        response.contentType = &quot;image/png&quot;;</span><br><span class="line">                        response.write( thread.table(&quot;iconlist&quot;)[&quot;folder&quot;] ) //发送文件夹图标    </span><br><span class="line">                    &#125;else&#123;</span><br><span class="line">                        var ext = fsys.getExtensionName(serverPath) //exe (没有.)</span><br><span class="line">                        if(ext==&#x27;exe&#x27;)&#123;</span><br><span class="line">                            response.contentType = &quot;image/png&quot;;</span><br><span class="line">                            response.write( winform.getfileIcon(serverPath) )</span><br><span class="line">                        &#125;else&#123;</span><br><span class="line">                            //在iconlist中找</span><br><span class="line">                            if(!thread.table(&quot;iconlist&quot;)[&quot;.&quot;+ ext])&#123;</span><br><span class="line">                                thread.table(&quot;iconlist&quot;)[&quot;.&quot;+ ext] = winform.getfileIcon(serverPath)</span><br><span class="line">                            &#125;</span><br><span class="line">                            response.contentType = &quot;image/png&quot;;</span><br><span class="line">                            response.write( thread.table(&quot;iconlist&quot;)[&quot;.&quot;+ ext] ) //发送文件夹图标        </span><br><span class="line">                        &#125;    </span><br><span class="line">                    &#125;</span><br><span class="line">                       </span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    //返回一个默认的图片</span><br><span class="line">                &#125;</span><br><span class="line">                return;</span><br><span class="line">            &#125;    </span><br><span class="line">              </span><br><span class="line">            //返回搜索结果(全站搜索，较慢)</span><br><span class="line">            if(request.path == &quot;/search&quot;)&#123;</span><br><span class="line">                var keyword = request.query(&quot;keywords&quot;)</span><br><span class="line">                if(keyword)&#123;</span><br><span class="line">                    var templist = &#123;&#125;</span><br><span class="line">                    fsys.enum( request.documentRoot, &quot;*.*&quot;, </span><br><span class="line">                        function(dir,filename,fullpath,findData)&#123; </span><br><span class="line">                            if(findData.dwFileAttributes &amp; 2/*_FILE_ATTRIBUTE_HIDDEN*/) return; //不搜索隐藏文件</span><br><span class="line">                            if(filename)&#123; </span><br><span class="line">                                   if( string.find(filename,&quot;@&quot;++keyword) )&#123;</span><br><span class="line">                                       var size = math.size64(findData.nFileSizeLow,findData.nFileSizeHigh).format()</span><br><span class="line">                                    var mdftime =  tostring(fsys.fromFileTime(findData.ftLastWriteTime),&quot;%Y-%m-%d %H:%M:%S&quot;);</span><br><span class="line">                                    var webPath = string.right(fullpath,-#request.documentRoot)</span><br><span class="line">                                    webPath = string.replace(webPath,&quot;@\&quot;,&quot;/&quot;)</span><br><span class="line">                                    table.push(templist,</span><br><span class="line">                                        &#123;[&quot;name&quot;]=filename,[&quot;size&quot;]=size,[&quot;time&quot;]=mdftime;[&quot;path&quot;]=webPath;[&quot;type&quot;]=0&#125;)</span><br><span class="line">                                   &#125;         </span><br><span class="line">                            &#125;</span><br><span class="line">                            else&#123;</span><br><span class="line">                                   if(string.find(dir,&quot;@&quot;++keyword))&#123;</span><br><span class="line">                                       var mdftime =  tostring(fsys.fromFileTime(findData.ftLastWriteTime),&quot;%Y-%m-%d %H:%M:%S&quot;);    </span><br><span class="line">                                    var webPath = string.right(fullpath,-#request.documentRoot)</span><br><span class="line">                                    webPath = string.replace(webPath,&quot;@\&quot;,&quot;/&quot;)</span><br><span class="line">                                    table.push(templist,</span><br><span class="line">                                        &#123;[&quot;name&quot;]=dir,[&quot;size&quot;]=&quot;/&quot;,[&quot;time&quot;]=mdftime;[&quot;path&quot;]=webPath;[&quot;type&quot;]=1&#125;) //设定type=1为目录</span><br><span class="line">                                   &#125;    </span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; ,true</span><br><span class="line">                    );</span><br><span class="line">                    var retlist = &#123;&#125;</span><br><span class="line">                    if(#templist&gt;0)&#123;</span><br><span class="line">                        retlist = table.mix(&#123;&#125;,&#123;&quot;code&quot;=0; &quot;msg&quot;=&quot;success&quot;;  &quot;count&quot;=#templist; &quot;data&quot;=templist&#125; )</span><br><span class="line">                    &#125;else&#123;</span><br><span class="line">                        retlist = &#123;&quot;code&quot;=2; &quot;msg&quot;=&quot;没有找到包含关键字的文件或目录&quot;;&#125;  //空目录</span><br><span class="line">                    &#125;</span><br><span class="line">                    var json = web.json.stringify(retlist,true)</span><br><span class="line">                    response.contentType = &quot;text/json&quot;</span><br><span class="line">                    response.write(json)</span><br><span class="line">                    return;</span><br><span class="line">                &#125;    </span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            //响应客户端-新建文件夹</span><br><span class="line">            if(request.path == &quot;/createfolder&quot;)&#123;              </span><br><span class="line">                var path = request.post[&quot;fatherdir&quot;]</span><br><span class="line">                var newname = request.post[&quot;foldername&quot;]</span><br><span class="line">                var serverPath = io.joinpath(request.documentRoot, path)</span><br><span class="line"></span><br><span class="line">                if(io.exist(serverPath))&#123;</span><br><span class="line">                    if(io.exist(io.joinpath(serverPath,newname))) &#123;</span><br><span class="line">                        response.errorStatus(417, &quot;已存在同名文件夹!&quot;)</span><br><span class="line">                        return;</span><br><span class="line">                    &#125; else&#123;</span><br><span class="line">                        if( fsys.createDir(io.joinpath(serverPath,newname)) )&#123;</span><br><span class="line">                            response.contentType = &quot;text/json&quot;</span><br><span class="line">                            response.write(&#x27;&#123;&quot;success&quot;:true&#125;&#x27;)</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;   </span><br><span class="line">                &#125;    </span><br><span class="line">                response.errorStatus(404, &quot;目录路径不正确&quot;)</span><br><span class="line">                return;</span><br><span class="line">            &#125;            </span><br><span class="line">              </span><br><span class="line">            //响应客户端-改名</span><br><span class="line">            if(request.path == &quot;/rename&quot;)&#123;              </span><br><span class="line">                var path = request.post[&quot;path&quot;]</span><br><span class="line">                var newname = request.post[&quot;newname&quot;]</span><br><span class="line">                var serverPath = io.joinpath(request.documentRoot, path)</span><br><span class="line">                var newpath = fsys.getParentDir(serverPath) + newname</span><br><span class="line"></span><br><span class="line">                if(io.exist(serverPath))&#123;</span><br><span class="line">                    if(fsys.rename(serverPath,newpath))&#123;</span><br><span class="line">                        response.contentType = &quot;text/json&quot;</span><br><span class="line">                        response.write(&#x27;&#123;&quot;success&quot;:true&#125;&#x27;)</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;    </span><br><span class="line">                response.errorStatus(404, &quot;File not found!&quot;)</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">             //响应客户端-删除</span><br><span class="line">             if(request.path == &quot;/delete&quot;)&#123;</span><br><span class="line">                var path = request.post[&quot;path&quot;]</span><br><span class="line">                var serverPath = io.joinpath(request.documentRoot, path)</span><br><span class="line">                </span><br><span class="line">                var recyclefolder = request.documentRoot + &quot;回收站&quot;</span><br><span class="line">                </span><br><span class="line">                if(fsys.isDir(serverPath))&#123;//如果要删除的是文件夹 (设为隐藏属性即可)</span><br><span class="line">                    fsys.attrib(serverPath,,2/*_FILE_ATTRIBUTE_HIDDEN*/)</span><br><span class="line">                    fsys.rename(serverPath,serverPath+&quot;-已删除&quot;)</span><br><span class="line">                    response.contentType = &quot;text/json&quot;</span><br><span class="line">                    response.write(&#x27;&#123;&quot;success&quot;:true&#125;&#x27;)    </span><br><span class="line">                    return;</span><br><span class="line">                &#125;else &#123;//如果要删除的是文件(移到回收站)</span><br><span class="line">                    if(io.exist(serverPath))&#123; //文件要真实存在</span><br><span class="line">                        var newdir = fsys.getParentDir( recyclefolder + io.joinpath(path) )</span><br><span class="line">                        if(!io.exist(newdir)) fsys.createDir(newdir)</span><br><span class="line">                        if(fsys.move(serverPath,recyclefolder + io.joinpath(path),0x614/*_FOF_NO_UI*/))&#123;</span><br><span class="line">                            response.contentType = &quot;text/json&quot;</span><br><span class="line">                            response.write(&#x27;&#123;&quot;success&quot;:true&#125;&#x27;)</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                response.errorStatus(404, &quot;未找到指定的文件&quot;)</span><br><span class="line">                return;</span><br><span class="line">            &#125;    </span><br><span class="line">                        </span><br><span class="line">            //响应客户端-文件下载  </span><br><span class="line">            if(request.path == &quot;/download/main.aardio&quot;)&#123;</span><br><span class="line">                var filePath = request.query(&quot;filepath&quot;)</span><br><span class="line">                var serverPath = io.joinpath(request.documentRoot, filePath)</span><br><span class="line">                </span><br><span class="line">                if(io.exist(serverPath))&#123;</span><br><span class="line">                    var file = io.open(serverPath,&quot;rb&quot;);</span><br><span class="line">                    response.contentType = &quot;application/octet-stream&quot;; </span><br><span class="line">                    response.headers[&quot;Content-Disposition&quot;] = &quot;attachment; filename=&quot;+ fsys.getFileName(serverPath); </span><br><span class="line">                    response.headers[&quot;Content-Length&quot;] = file.size();</span><br><span class="line"></span><br><span class="line">                      var buffer = raw.buffer(1024 *100);</span><br><span class="line">                      while(var readsize = file.readBuffer(buffer))&#123;</span><br><span class="line">                        response.writeBuffer(buffer,readsize)</span><br><span class="line">                      &#125;</span><br><span class="line">                      file.close()</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    response.errorStatus(404, &quot;File not found!&quot;)</span><br><span class="line">                &#125;</span><br><span class="line">                return;   </span><br><span class="line">            &#125; </span><br><span class="line">            </span><br><span class="line">            //响应客户端-文件上传</span><br><span class="line">             if(request.path == &quot;/updatefile&quot;)&#123;</span><br><span class="line">                 var fileData = request.postFileData();  //获取上传的文件</span><br><span class="line">                if(fileData)&#123;</span><br><span class="line">                    var filename = fileData[&quot;file&quot;].filename</span><br><span class="line">                     var path = fileData[&quot;dirpath&quot;].value()   //取layui上传文件的data附加数据</span><br><span class="line">                     var serverfolder = io.joinpath(request.documentRoot, path)</span><br><span class="line">                     //保存文件到指定位置</span><br><span class="line">                    fileData[&quot;file&quot;].save(serverfolder + &quot;\&quot; + filename);  </span><br><span class="line"></span><br><span class="line">                    //layui-upload组件要求上传成功后，必须返回的json</span><br><span class="line">                    response.contentType = &quot;text/json&quot;</span><br><span class="line">                    var retJson = &#x27;&#123; &quot;code&quot;: 0, &quot;msg&quot;: &quot;&#x27; ++ filename ++ &#x27;&quot;&#125;&#x27;</span><br><span class="line">                    response.write(retJson)</span><br><span class="line">                    return; </span><br><span class="line">                 &#125;</span><br><span class="line">                 response.contentType = &quot;text/json&quot;</span><br><span class="line">                response.write(&#x27;&#123; &quot;code&quot;: 1, &quot;msg&quot;: &quot;未知错误&quot;&#125;&#x27;)</span><br><span class="line">                 return;    </span><br><span class="line">             &#125;</span><br><span class="line">                 </span><br><span class="line">            //响应其他格式的文件请求</span><br><span class="line">            //response.headers[&quot;Access-Control-Allow-Origin&quot;] = &quot;*&quot; //允许跨域(如在线打开office文件)</span><br><span class="line">            response.loadcode( request.path );</span><br><span class="line">        &#125;</span><br><span class="line">    );  </span><br><span class="line">    </span><br><span class="line">    winform.edit.disabled = true</span><br><span class="line">    winform.btnOpenFolder.disabled = true</span><br><span class="line">    winform.btnStart.text = &quot;停止服务器&quot;;</span><br><span class="line">    winform.weblink.text = `网站已运行 (主页： &lt;a href=&quot;` ++ url ++ `&quot;&gt;` ++ url ++ &quot;&lt;/a&gt; )&quot;</span><br><span class="line"></span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        //停止服务器 </span><br><span class="line">        //(如需反复重启，需要修改wsock.tcp.wsock.tcp.simpleHttpServer源码第806行</span><br><span class="line">        //if(serverMain) serverMain.stop();</span><br><span class="line">        //为：if(serverMain) serverMain.stop(); serverMain=null;</span><br><span class="line">        //)</span><br><span class="line">        wsock.tcp.simpleHttpServer.stopUrl()</span><br><span class="line"></span><br><span class="line">        winform.edit.disabled = false</span><br><span class="line">        winform.btnOpenFolder.disabled = false</span><br><span class="line">        winform.weblink.text = &quot;网站未运行&quot;</span><br><span class="line">        winform.btnStart.text = &quot;启动服务器&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//在浏览器打开网页</span><br><span class="line">winform.weblink.onHyperlinkClick = function(nmSysLink,url,id)&#123;</span><br><span class="line">    thread.invoke(</span><br><span class="line">        function(url)&#123;</span><br><span class="line">            import process;</span><br><span class="line">            process.execute(url);</span><br><span class="line">        &#125;,url</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//设置共享文件夹</span><br><span class="line">winform.btnOpenFolder.oncommand = function(id,event)&#123;</span><br><span class="line">    var folderPath = fsys.dlg.dir()</span><br><span class="line">    if(folderPath)&#123;</span><br><span class="line">        if(string.endWith(folderPath,&quot;\&quot;)==false) folderPath+= &quot;\&quot;</span><br><span class="line">        winform.edit.text = folderPath;</span><br><span class="line">        winform.root = folderPath;</span><br><span class="line">        //设置为网站根目录</span><br><span class="line">        wsock.tcp.simpleHttpServer.documentRoot = folderPath ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">winform.show();</span><br><span class="line">win.loopMessage();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>还有一个web.html页面，需要自己放在一个服务器上，以便于上面的代码下载到本地运行。</p>
<p>web.html代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>在线文件管理系统<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 引入layui.css --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/layui/2.8.17/css/layui.min.css&quot;</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 自定义CSS样式 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">			<span class="comment">/* 修改header样式：更换前景色、背景色，文本居中 */</span></span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.layui-table-header</span>, <span class="selector-class">.layui-table-header</span> <span class="selector-tag">th</span>, <span class="selector-class">.layui-table</span> <span class="selector-tag">thead</span> <span class="selector-tag">tr</span> &#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">background-color</span>: <span class="number">#16BAAA</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			<span class="comment">/*修改table行高*/</span></span></span><br><span class="line"><span class="language-css">			<span class="selector-tag">td</span>&gt;<span class="selector-class">.layui-table-cell</span> &#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">height</span>:<span class="number">55px</span>;</span></span><br><span class="line"><span class="language-css">			&#125;	</span></span><br><span class="line"><span class="language-css">			<span class="comment">/* 修改搜索框高度 */</span></span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.layui-input-wrap</span>&gt;<span class="selector-class">.layui-input</span>,</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.layui-input-wrap</span>&gt;<span class="selector-class">.layui-input-affix</span>,</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.layui-input-wrap</span>&gt;<span class="selector-class">.layui-input-suffix</span>,</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.layui-input-wrap</span>&gt;<span class="selector-class">.layui-icon</span> &#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">line-height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			</span></span><br><span class="line"><span class="language-css">			<span class="comment">/*缩略图样式*/</span></span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.fileDirIcon</span> &#123;</span></span><br><span class="line"><span class="language-css">			    <span class="attribute">width</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">			    <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">			    <span class="attribute">padding</span>: <span class="number">2px</span>;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			</span></span><br><span class="line"><span class="language-css">			<span class="comment">/*目录名&amp;文件名链接*/</span></span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.fileDirIcon</span>+<span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">color</span>:<span class="number">#F00</span>;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			</span></span><br><span class="line"><span class="language-css">			<span class="comment">/* 修改layer对话框标题栏高度 */</span></span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.layui-layer-title</span> &#123;</span></span><br><span class="line"><span class="language-css">			    <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">			    <span class="attribute">line-height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">background-color</span>: <span class="number">#16baaa</span>;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			</span></span><br><span class="line"><span class="language-css">			<span class="comment">/* 修改layer对话框右上角x号的位置 */</span></span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.layui-layer-setwin</span> &#123;</span></span><br><span class="line"><span class="language-css">				<span class="attribute">top</span>:<span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">			&#125;</span></span><br><span class="line"><span class="language-css">			</span></span><br><span class="line"><span class="language-css">			<span class="comment">/* 自定义删除对话框样式 */</span></span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.class-layer-Warning</span> <span class="selector-class">.layui-layer-title</span>&#123;<span class="attribute">background-color</span>: <span class="number">#ffb800</span>;&#125;</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.class-layer-Warning</span> <span class="selector-class">.layui-layer-btn</span>&#123;<span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span> <span class="number">10px</span>;&#125;</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.class-layer-Warning</span> <span class="selector-class">.layui-layer-btn</span> <span class="selector-tag">a</span>&#123;<span class="attribute">background</span>: <span class="number">#fff</span>; <span class="attribute">border-color</span>: <span class="number">#E9E7E7</span>; <span class="attribute">color</span>: <span class="number">#333</span>;&#125;</span></span><br><span class="line"><span class="language-css">			<span class="selector-class">.class-layer-Warning</span> <span class="selector-class">.layui-layer-btn</span> <span class="selector-class">.layui-layer-btn0</span>&#123;<span class="attribute">border-color</span>: <span class="number">#FA584D</span>; <span class="attribute">background-color</span>: <span class="number">#FA584D</span>; <span class="attribute">color</span>: <span class="number">#fff</span>;&#125;</span></span><br><span class="line"><span class="language-css">		</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span> <span class="attr">style</span>=<span class="string">&quot;background-color: bisque;&quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-container&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-panel&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin: 10px; padding: 10px;&quot;</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- header --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-row&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding: 5px;&quot;</span>&gt;</span></span><br><span class="line">					<span class="comment">&lt;!-- logo --&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-inline&quot;</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;logo&quot;</span> <span class="attr">href</span>=<span class="string">&quot;javascript:void(0);&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;javascript:location.href=&#x27;/&#x27;&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;layui-nav-img layui-panel&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding:5px;&quot;</span></span></span><br><span class="line"><span class="tag">								 <span class="attr">src</span>=<span class="string">&quot;/logo.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;logo&quot;</span> /&gt;</span></span><br><span class="line">								<span class="comment">&lt;!-- src=&quot;thumbnail/aardio.exe&quot; alt=&quot;logo&quot; /&gt;  --&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;layui-inline layui-font-green&quot;</span>&gt;</span>&lt;?=owner.title?&gt;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">					<span class="comment">&lt;!-- search --&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-form layui-inline&quot;</span> <span class="attr">style</span>=<span class="string">&quot;float: right;padding-top:15px;&quot;</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-input-wrap&quot;</span>&gt;</span></span><br><span class="line">							<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;layui-input&quot;</span> <span class="attr">lay-affix</span>=<span class="string">&quot;search&quot;</span> <span class="attr">lay-filter</span>=<span class="string">&quot;search&quot;</span></span></span><br><span class="line"><span class="tag">								<span class="attr">placeholder</span>=<span class="string">&quot;查找…&quot;</span>&gt;</span></span><br><span class="line">						<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- breadcrumb --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-row&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding-top:10px;padding-left:10px;&quot;</span>&gt;</span></span><br><span class="line">					<span class="comment">&lt;!-- 导航条(面包屑) --&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;layui-breadcrumb&quot;</span> <span class="attr">id</span>=<span class="string">&quot;breadcrumb&quot;</span> <span class="attr">lay-separator</span>=<span class="string">&quot;&gt;&quot;</span> <span class="attr">lay-filter</span>=<span class="string">&quot;breadcrumb-bar&quot;</span>&gt;</span></span><br><span class="line">						&lt;?=owner.nav?&gt;</span><br><span class="line">					<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">&lt;!-- table --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-row&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding-top:5px;&quot;</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">&quot;layui-hide&quot;</span> <span class="attr">id</span>=<span class="string">&quot;table-file-list&quot;</span> <span class="attr">lay-filter</span>=<span class="string">&quot;table-file-list&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">&lt;!-- footer --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-row&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align: center; padding-top:20px;line-height:1.5em;&quot;</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;layui-font-13&quot;</span>&gt;</span>Copyright © 2023 &lt;?=owner.admin?&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;layui-font-12 layui-font-gray&quot;</span>&gt;</span>Powered by <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.aardio.com/&quot;</span> <span class="attr">class</span>=<span class="string">&quot;layui-font-gray&quot;</span>&gt;</span>aardio<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">						&amp; <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://layui.dev/&quot;</span>  <span class="attr">class</span>=<span class="string">&quot;layui-font-gray&quot;</span>&gt;</span>layui<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">					<span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">&quot;currDir&quot;</span>&gt;</span>&lt;?=owner.currDir?&gt;<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!--  自定义模板区 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;toolbar&quot;</span>&gt;</span><span class="language-handlebars"><span class="language-xml"><span class="comment">&lt;!-- 头工具栏模板 --&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn-container&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn layui-btn-primary layui-btn-sm&quot;</span> <span class="attr">lay-event</span>=<span class="string">&quot;createDir&quot;</span> &gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;layui-icon layui-icon-layer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>新建目录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">				<span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn layui-btn-primary layui-btn-sm&quot;</span> <span class="attr">id</span>=<span class="string">&quot;uploadfile&quot;</span> <span class="attr">lay-event</span>=<span class="string">&quot;updateFlie&quot;</span> <span class="attr">lay-options</span>=<span class="string">&quot;&#123;accept: &#x27;file&#x27;&#125;&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;layui-icon layui-icon-upload&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>上传文件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">		</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/html&quot;</span> <span class="attr">id</span>=<span class="string">&quot;colbar&quot;</span>&gt;</span><span class="language-handlebars"><span class="language-xml"><span class="comment">&lt;!-- 指定列模板 --&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn layui-btn-sm </span></span></span><span class="template-variable">&#123;&#123;=(<span class="name">d.type</span>==<span class="number">1</span>)?<span class="string">&#x27;layui-btn-disabled&#x27;</span>:<span class="string">&#x27;&#x27;</span>&#125;&#125;</span><span class="language-xml"><span class="tag"><span class="string">&quot;</span> <span class="attr">title</span>=<span class="string">&quot;下载&quot;</span> <span class="attr">lay-event</span>=<span class="string">&quot;download&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;layui-icon layui-icon-download-circle layui-font-18&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn layui-btn-sm layui-bg-orange&quot;</span> <span class="attr">title</span>=<span class="string">&quot;重命名&quot;</span> <span class="attr">lay-event</span>=<span class="string">&quot;rename&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;layui-icon layui-icon-edit layui-font-18&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;layui-btn layui-btn-sm layui-bg-red&quot;</span> <span class="attr">title</span>=<span class="string">&quot;删除&quot;</span> <span class="attr">lay-event</span>=<span class="string">&quot;delete&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;layui-icon layui-icon-delete layui-icon-tips layui-font-18&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">		</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- 华丽的分割线 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdnjs.cloudflare.com/ajax/libs/layui/2.8.17/layui.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">			layui.<span class="title function_">use</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">				<span class="keyword">var</span> layer = layui.<span class="property">layer</span>;</span></span><br><span class="line"><span class="language-javascript">				<span class="keyword">var</span> table = layui.<span class="property">table</span>;</span></span><br><span class="line"><span class="language-javascript">				<span class="keyword">var</span> form = layui.<span class="property">form</span>;</span></span><br><span class="line"><span class="language-javascript">				<span class="keyword">var</span> upload = layui.<span class="property">upload</span>;</span></span><br><span class="line"><span class="language-javascript">				<span class="keyword">var</span> util = layui.<span class="property">util</span>;</span></span><br><span class="line"><span class="language-javascript">				<span class="keyword">var</span> $ = layui.<span class="property">$</span>;</span></span><br><span class="line"><span class="language-javascript">								</span></span><br><span class="line"><span class="language-javascript">				<span class="comment">//渲染面包屑nav</span></span></span><br><span class="line"><span class="language-javascript">				<span class="keyword">var</span> element = layui.<span class="property">element</span>;</span></span><br><span class="line"><span class="language-javascript">				element.<span class="title function_">render</span>(<span class="string">&#x27;breadcrumb&#x27;</span>, <span class="string">&#x27;breadcrumb-bar&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">				</span></span><br><span class="line"><span class="language-javascript">				<span class="comment">//渲染table</span></span></span><br><span class="line"><span class="language-javascript">				table.<span class="title function_">render</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">elem</span>: <span class="string">&#x27;#table-file-list&#x27;</span>, <span class="comment">//要渲染的标签</span></span></span><br><span class="line"><span class="language-javascript">					<span class="attr">url</span>: <span class="string">&#x27;getfolder?folderpath=&lt;?=owner.table_url?&gt;&#x27;</span>, <span class="comment">// 接口数据</span></span></span><br><span class="line"><span class="language-javascript">					<span class="attr">id</span>:  <span class="string">&#x27;filelist&#x27;</span>, <span class="comment">//id（用于识别cachedata、重载数据等操作）</span></span></span><br><span class="line"><span class="language-javascript">					<span class="attr">title</span>: <span class="string">&#x27;服务器共享目录内容列表&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">toolbar</span>: <span class="string">&#x27;#toolbar&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">cols</span>: [[</span></span><br><span class="line"><span class="language-javascript">							&#123;</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">field</span>: <span class="string">&#x27;name&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">title</span>: <span class="string">&#x27;名 称&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">minWidth</span>: <span class="number">250</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">templet</span>: <span class="string">&#x27;&lt;div&gt;&lt;img class=&quot;fileDirIcon&quot; src=&quot;thumbnail&#123;&#123;= d.path&#125;&#125;&quot;/&gt;&lt;a style=&quot;padding:3px;&quot; lay-event=&quot;reload&quot; href=&quot;javascript:;&quot;&gt;&#123;&#123;= d.name &#125;&#125;&lt;/a&gt;&lt;/div&gt;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">							&#125;,</span></span><br><span class="line"><span class="language-javascript">							&#123;</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">field</span>: <span class="string">&#x27;size&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">title</span>: <span class="string">&#x27;大 小&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">width</span>: <span class="number">120</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">							&#125;,</span></span><br><span class="line"><span class="language-javascript">							&#123;</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">field</span>: <span class="string">&#x27;time&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">title</span>: <span class="string">&#x27;修改时间&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">width</span>: <span class="number">180</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">							&#125;,</span></span><br><span class="line"><span class="language-javascript">							&#123;</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">title</span>: <span class="string">&#x27;操 作&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">width</span>: <span class="number">200</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">templet</span>: <span class="string">&#x27;#colbar&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								<span class="attr">align</span>: <span class="string">&#x27;center&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">							&#125;,</span></span><br><span class="line"><span class="language-javascript">					]],</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">initSort</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">					 <span class="attr">field</span>: <span class="string">&#x27;type&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">					 <span class="attr">type</span>: <span class="string">&#x27;desc&#x27;</span></span></span><br><span class="line"><span class="language-javascript">					&#125;,</span></span><br><span class="line"><span class="language-javascript">				&#125;);</span></span><br><span class="line"><span class="language-javascript">			</span></span><br><span class="line"><span class="language-javascript">				<span class="comment">//渲染上传组件</span></span></span><br><span class="line"><span class="language-javascript">				upload.<span class="title function_">render</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">				    <span class="attr">elem</span>: <span class="string">&#x27;#uploadfile&#x27;</span>, <span class="comment">// 绑定按钮</span></span></span><br><span class="line"><span class="language-javascript">				    <span class="attr">url</span>: <span class="string">&#x27;updatefile&#x27;</span>,   <span class="comment">// 上传接口</span></span></span><br><span class="line"><span class="language-javascript">				    <span class="attr">accept</span>: <span class="string">&#x27;file&#x27;</span>,	     <span class="comment">// 普通文件</span></span></span><br><span class="line"><span class="language-javascript">					<span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">					  <span class="attr">dirpath</span>:  <span class="keyword">function</span>(<span class="params"></span>)&#123; <span class="keyword">return</span> $(<span class="string">&quot;#currDir&quot;</span>).<span class="title function_">html</span>() &#125;,</span></span><br><span class="line"><span class="language-javascript">					&#125;,</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">before</span>: <span class="keyword">function</span>(<span class="params">obj</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">						$(<span class="string">&#x27;#uploadfile&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;layui-btn-disabled&#x27;</span>); </span></span><br><span class="line"><span class="language-javascript">					&#125;,</span></span><br><span class="line"><span class="language-javascript">				    <span class="attr">done</span>: <span class="keyword">function</span>(<span class="params">res</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">						$(<span class="string">&#x27;#uploadfile&#x27;</span>).<span class="title function_">html</span>(<span class="string">&#x27;&lt;i class=&quot;layui-icon layui-icon-upload&quot;&gt;&lt;/i&gt;上传文件&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">						$(<span class="string">&#x27;#uploadfile&#x27;</span>).<span class="title function_">removeClass</span>(<span class="string">&#x27;layui-btn-disabled&#x27;</span>); </span></span><br><span class="line"><span class="language-javascript">						<span class="comment">// 若上传失败</span></span></span><br><span class="line"><span class="language-javascript">						<span class="keyword">if</span> (res.<span class="property">code</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">return</span> layer.<span class="title function_">msg</span>(<span class="string">&#x27;上传失败&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">						&#125;</span></span><br><span class="line"><span class="language-javascript">						layer.<span class="title function_">msg</span>(<span class="string">&#x27;上传成功&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">						table.<span class="title function_">reloadData</span>(<span class="string">&#x27;filelist&#x27;</span>,&#123;</span></span><br><span class="line"><span class="language-javascript">							<span class="attr">url</span>:<span class="string">&#x27;getfolder?folderpath=&#x27;</span> + <span class="title function_">lay</span>(<span class="string">&quot;#currDir&quot;</span>).<span class="title function_">html</span>()</span></span><br><span class="line"><span class="language-javascript">						&#125;);</span></span><br><span class="line"><span class="language-javascript">						</span></span><br><span class="line"><span class="language-javascript">					  </span></span><br><span class="line"><span class="language-javascript">				    &#125;,</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">error</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">						$(<span class="string">&#x27;#uploadfile&#x27;</span>).<span class="title function_">removeClass</span>(<span class="string">&#x27;layui-btn-disabled&#x27;</span>); </span></span><br><span class="line"><span class="language-javascript">					&#125;,</span></span><br><span class="line"><span class="language-javascript">					<span class="attr">progress</span>: <span class="keyword">function</span>(<span class="params">n, elem, e</span>) &#123;	<span class="comment">// 进度条</span></span></span><br><span class="line"><span class="language-javascript">						$(<span class="string">&#x27;#uploadfile&#x27;</span>).<span class="title function_">html</span>(<span class="string">&#x27;&lt;i class=&quot;layui-icon layui-icon-loading&quot;&gt;&lt;/i&gt; 正在上传：&#x27;</span> + n + <span class="string">&#x27; %&amp;nbsp&amp;nbsp&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">					&#125;,</span></span><br><span class="line"><span class="language-javascript">				&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">				<span class="comment">//table中列工具事件</span></span></span><br><span class="line"><span class="language-javascript">				table.<span class="title function_">on</span>(<span class="string">&#x27;tool(table-file-list)&#x27;</span>, <span class="keyword">function</span>(<span class="params">obj</span>) &#123; </span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">var</span> data = obj.<span class="property">data</span>; <span class="comment">// 获得当前行数据</span></span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">switch</span> (obj.<span class="property">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">						<span class="keyword">case</span> <span class="string">&#x27;reload&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">if</span>(data.<span class="property">type</span> == <span class="number">1</span>)&#123; <span class="comment">//如果点击了目录名，自动更新table</span></span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">var</span> newpath = data.<span class="property">path</span>;</span></span><br><span class="line"><span class="language-javascript">								table.<span class="title function_">reloadData</span>(<span class="string">&#x27;filelist&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">url</span>: <span class="string">&#x27;getfolder?folderpath=&#x27;</span> + newpath, <span class="comment">// 更改目录接口</span></span></span><br><span class="line"><span class="language-javascript">									<span class="attr">done</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="comment">//修改面包屑</span></span></span><br><span class="line"><span class="language-javascript">										<span class="keyword">var</span> list = newpath.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">										<span class="keyword">var</span> lst = <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">										<span class="keyword">var</span> tmp = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">										layui.<span class="title function_">each</span>(list,<span class="keyword">function</span>(<span class="params">index, item</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">											tmp += item + <span class="string">&quot;/&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">											<span class="keyword">if</span>(index&lt;list.<span class="property">length</span>-<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">												<span class="keyword">if</span>(item==<span class="string">&quot;&quot;</span>) item=<span class="string">&quot;根目录&quot;</span></span></span><br><span class="line"><span class="language-javascript">												lst += <span class="string">&#x27;&lt;a href=&quot;/?folderpath=&#x27;</span> + tmp + <span class="string">&#x27;&quot;&gt;&#x27;</span> + item + <span class="string">&#x27;&lt;/a&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">											&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-javascript">												lst += <span class="string">&#x27;&lt;a&gt;&lt;cite&gt;&#x27;</span> + item + <span class="string">&#x27;&lt;/cite&gt;&lt;/a&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">											&#125;</span></span><br><span class="line"><span class="language-javascript">										&#125;);</span></span><br><span class="line"><span class="language-javascript">										<span class="title function_">lay</span>(<span class="string">&quot;#breadcrumb&quot;</span>).<span class="title function_">html</span>( lst );</span></span><br><span class="line"><span class="language-javascript">										element.<span class="title function_">render</span>(<span class="string">&#x27;breadcrumb&#x27;</span>, <span class="string">&#x27;breadcrumb-bar&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">										<span class="comment">//修改currDir字段</span></span></span><br><span class="line"><span class="language-javascript">										<span class="title function_">lay</span>(<span class="string">&quot;#currDir&quot;</span>).<span class="title function_">html</span>(data.<span class="property">path</span>);</span></span><br><span class="line"><span class="language-javascript">									&#125;</span></span><br><span class="line"><span class="language-javascript">								&#125;);</span></span><br><span class="line"><span class="language-javascript">							&#125;</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">if</span>(data.<span class="property">type</span> == <span class="number">0</span>)&#123; <span class="comment">//如果点击了文件名</span></span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">var</span> ext = data.<span class="property">name</span>.<span class="title function_">substring</span>(data.<span class="property">name</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>)).<span class="title function_">toLowerCase</span>(); <span class="comment">//.txt</span></span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">var</span> imgfiles = [<span class="string">&#x27;.bmp&#x27;</span>,<span class="string">&#x27;.jpg&#x27;</span>,<span class="string">&#x27;.gif&#x27;</span>,<span class="string">&#x27;.png&#x27;</span>,<span class="string">&#x27;.webp&#x27;</span>,<span class="string">&#x27;.jpeg&#x27;</span>,<span class="string">&#x27;.svg&#x27;</span>,<span class="string">&#x27;.tif&#x27;</span>];</span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">var</span> videofiles = [<span class="string">&#x27;.mp4&#x27;</span>,<span class="string">&#x27;.ogg&#x27;</span>,<span class="string">&#x27;.mp3&#x27;</span>,<span class="string">&#x27;.mov&#x27;</span>,<span class="string">&#x27;.mpg&#x27;</span>,<span class="string">&#x27;.mpeg&#x27;</span>,<span class="string">&#x27;.mpeg4&#x27;</span>,<span class="string">&#x27;.webm&#x27;</span>,<span class="string">&#x27;.wav&#x27;</span>,<span class="string">&#x27;.webv&#x27;</span>]; </span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">var</span> txtfiles = [<span class="string">&#x27;.txt&#x27;</span>,<span class="string">&#x27;.ini&#x27;</span>,<span class="string">&#x27;.json&#x27;</span>,<span class="string">&#x27;.xml&#x27;</span>,<span class="string">&#x27;.html&#x27;</span>,<span class="string">&#x27;.js&#x27;</span>,<span class="string">&#x27;.css&#x27;</span>];</span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">var</span> officefiles = [<span class="string">&#x27;.doc&#x27;</span>,<span class="string">&#x27;.docx&#x27;</span>,<span class="string">&#x27;.xls&#x27;</span>,<span class="string">&#x27;.xlsx&#x27;</span>,<span class="string">&#x27;.ppt&#x27;</span>,<span class="string">&#x27;.pptx&#x27;</span>,<span class="string">&#x27;.pdf&#x27;</span>];</span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">if</span>($.<span class="title function_">inArray</span>(ext,imgfiles) != -<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="comment">//如果是图片，预览</span></span></span><br><span class="line"><span class="language-javascript">									layer.<span class="title function_">photos</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">shade</span>: <span class="number">0.8</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">toolbar</span>:<span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">hideFooter</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">photos</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">										  <span class="string">&quot;data&quot;</span>: [ &#123;<span class="string">&quot;src&quot;</span>: data.<span class="property">path</span>&#125; ],</span></span><br><span class="line"><span class="language-javascript">										&#125;,</span></span><br><span class="line"><span class="language-javascript">									&#125;)</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">								&#125;</span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">if</span>($.<span class="title function_">inArray</span>(ext,videofiles) != -<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="comment">//如果是视频，预览</span></span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">var</span> html = <span class="string">&#x27;&lt;div class=&quot;wrap&quot; id=&quot;player&quot;&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">									html += <span class="string">&#x27;&lt;video controls autobuffer=&quot;autobuffer&quot; autoplay=&quot;autoplay&quot; &gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">									html += <span class="string">&#x27;&lt;source src=&quot;&#x27;</span>+ data.<span class="property">path</span> +<span class="string">&#x27;&quot; type=&quot;video/mp4&quot; /&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">									html += <span class="string">&#x27;&lt;/video&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">									html += <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">									layer.<span class="title function_">open</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">type</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">skin</span>: <span class="string">&#x27;layui-layer-rim&#x27;</span>, <span class="comment">//加上边框</span></span></span><br><span class="line"><span class="language-javascript">										<span class="attr">title</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">shade</span>: <span class="number">0.8</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">shadeClose</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">move</span>:<span class="string">&#x27;#player&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">offset</span>:<span class="string">&#x27;50px&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">fixed</span>: <span class="literal">true</span>, <span class="comment">//固定</span></span></span><br><span class="line"><span class="language-javascript">										<span class="attr">content</span>: html,</span></span><br><span class="line"><span class="language-javascript">									&#125;);</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">								&#125;</span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">if</span>($.<span class="title function_">inArray</span>(ext,txtfiles) != -<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="comment">//如果是文本，预览</span></span></span><br><span class="line"><span class="language-javascript">									$.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">url</span>: data.<span class="property">path</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">type</span>:<span class="string">&quot;get&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">dataType</span>:<span class="string">&#x27;text&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">success</span>:<span class="keyword">function</span>(<span class="params">res</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">											layer.<span class="title function_">open</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">												<span class="attr">type</span>: <span class="number">1</span>, <span class="comment">// 页面层类型</span></span></span><br><span class="line"><span class="language-javascript">												<span class="attr">skin</span>: <span class="string">&#x27;layui-layer-win10&#x27;</span>, <span class="comment">// 2.8+</span></span></span><br><span class="line"><span class="language-javascript">												<span class="attr">shade</span>: <span class="number">0.8</span>,</span></span><br><span class="line"><span class="language-javascript">												<span class="attr">area</span>: [<span class="string">&#x27;70%&#x27;</span>, <span class="string">&#x27;60%&#x27;</span>],</span></span><br><span class="line"><span class="language-javascript">												<span class="attr">maxmin</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">												<span class="attr">title</span>: data.<span class="property">name</span>,</span></span><br><span class="line"><span class="language-javascript">												<span class="attr">content</span>: [</span></span><br><span class="line"><span class="language-javascript">														<span class="string">&#x27;&lt;div style=&quot;padding: 0 8px; height: 20px; line-height: 20px; border-bottom: 1px solid #F0F0F0; box-sizing: border-box; font-size: 12px;&quot;&gt;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">														<span class="comment">// 自定义菜单，此处仅作样式演示，具体功能可自主实现</span></span></span><br><span class="line"><span class="language-javascript">														[</span></span><br><span class="line"><span class="language-javascript">														  <span class="string">&#x27;&lt;a href=&quot;javascript:;&quot;&gt;文件(F)&lt;/a&gt;&amp;nbsp;&amp;nbsp;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">														  <span class="string">&#x27;&lt;a href=&quot;javascript:;&quot;&gt;编辑(E)&lt;/a&gt;&amp;nbsp;&amp;nbsp;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">														  <span class="string">&#x27;&lt;a href=&quot;javascript:;&quot;&gt;格式(O)&lt;/a&gt;&amp;nbsp;&amp;nbsp;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">														  <span class="string">&#x27;&lt;a href=&quot;javascript:;&quot;&gt;查看(V)&lt;/a&gt;&amp;nbsp;&amp;nbsp;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">														  <span class="string">&#x27;&lt;a href=&quot;javascript:;&quot;&gt;帮助(H)&lt;/a&gt;&#x27;</span>, </span></span><br><span class="line"><span class="language-javascript">														].<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>),</span></span><br><span class="line"><span class="language-javascript">														<span class="string">&#x27;&lt;/div&gt;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">														[</span></span><br><span class="line"><span class="language-javascript">															<span class="string">&#x27;&lt;textarea style=&quot;position: absolute; top: 20px; width: 100%; height: calc(100% - 20px); padding: 6px; border: none; resize: none; overflow-y: scroll; box-sizing: border-box;&quot;&gt;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">															util.<span class="built_in">escape</span>(res),</span></span><br><span class="line"><span class="language-javascript">															<span class="string">&#x27;&lt;/textarea&gt;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">														].<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">													].<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">											&#125;);</span></span><br><span class="line"><span class="language-javascript">										&#125;,</span></span><br><span class="line"><span class="language-javascript">									&#125;)</span></span><br><span class="line"><span class="language-javascript">								&#125;</span></span><br><span class="line"><span class="language-javascript">								</span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">if</span>($.<span class="title function_">inArray</span>(ext,officefiles) != -<span class="number">1</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="comment">//如果是office或pdf，预览</span></span></span><br><span class="line"><span class="language-javascript">									</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">var</span> host = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">hostname</span>;</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">if</span>( host == <span class="string">&#x27;127.0.0.1&#x27;</span> || host.<span class="title function_">toLowerCase</span>() == <span class="string">&#x27;localhost&#x27;</span> || host.<span class="title function_">startsWith</span>(<span class="string">&quot;192.168&quot;</span>)==<span class="literal">true</span> )&#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="comment">//内网访问</span></span></span><br><span class="line"><span class="language-javascript">										<span class="comment">//一般浏览器都能预览pdf</span></span></span><br><span class="line"><span class="language-javascript">										<span class="keyword">if</span>(ext ==<span class="string">&#x27;.pdf&#x27;</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">											<span class="variable language_">window</span>.<span class="title function_">open</span>(data.<span class="property">path</span>);</span></span><br><span class="line"><span class="language-javascript">										&#125;</span></span><br><span class="line"><span class="language-javascript">									&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="comment">//外网访问</span></span></span><br><span class="line"><span class="language-javascript">										layer.<span class="title function_">open</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">											<span class="attr">type</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">											<span class="attr">title</span>: data.<span class="property">name</span>, </span></span><br><span class="line"><span class="language-javascript">											<span class="attr">skin</span>: <span class="string">&#x27;layui-layer-win10&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">											<span class="attr">area</span>: [<span class="string">&#x27;60%&#x27;</span>, <span class="string">&#x27;78%&#x27;</span>],  <span class="comment">// 弹框大小</span></span></span><br><span class="line"><span class="language-javascript">											<span class="attr">moveType</span>: <span class="number">1</span>, <span class="comment">//拖拽模式，0或者1</span></span></span><br><span class="line"><span class="language-javascript">											<span class="comment">//下面这句要生效，必须是本文件服务器映射到外网域名</span></span></span><br><span class="line"><span class="language-javascript">											<span class="attr">content</span>: <span class="string">&quot;https://view.officeapps.live.com/op/view.aspx?src=&quot;</span> + util.<span class="built_in">escape</span>( <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">host</span> + data.<span class="property">path</span>) + <span class="string">&quot;&amp;wdOrigin=BROWSELINK&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">											<span class="attr">maxmin</span>: <span class="literal">true</span></span></span><br><span class="line"><span class="language-javascript">										&#125;);</span></span><br><span class="line"><span class="language-javascript">									&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">								&#125;</span></span><br><span class="line"><span class="language-javascript">								<span class="comment">//其他，不响应就行了</span></span></span><br><span class="line"><span class="language-javascript">							&#125;</span></span><br><span class="line"><span class="language-javascript">								</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">break</span>;	</span></span><br><span class="line"><span class="language-javascript">						<span class="keyword">case</span> <span class="string">&#x27;download&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">if</span>(data.<span class="property">type</span> == <span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">var</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">								link.<span class="property">href</span> = <span class="string">&#x27;/download/?filepath=&#x27;</span> + util.<span class="built_in">escape</span>(data.<span class="property">path</span>) ;</span></span><br><span class="line"><span class="language-javascript">								link.<span class="property">download</span> = data.<span class="property">name</span> || <span class="string">&quot;未知文件&quot;</span>;				</span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">var</span> event = <span class="keyword">new</span> <span class="title class_">MouseEvent</span>(<span class="string">&#x27;click&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">								link.<span class="title function_">dispatchEvent</span>(event);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">							&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-javascript">								layer.<span class="title function_">msg</span>(<span class="string">&quot;暂不支持目录下载&quot;</span>,&#123;<span class="attr">icon</span>: <span class="number">5</span>&#125;);</span></span><br><span class="line"><span class="language-javascript">							&#125;</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">						<span class="keyword">case</span> <span class="string">&#x27;rename&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">							layer.<span class="title function_">prompt</span>(</span></span><br><span class="line"><span class="language-javascript">								&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">title</span>:  data.<span class="property">type</span>==<span class="number">1</span>?<span class="string">&#x27;请输入新的目录名&#x27;</span>:<span class="string">&#x27;请输入新的文件名&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">placeholder</span>: data.<span class="property">name</span>,</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">formType</span>: <span class="number">0</span>,  <span class="comment">//0为单行文本(默认)；1为密码；2为多行文本</span></span></span><br><span class="line"><span class="language-javascript">									<span class="comment">//skin: &#x27;layui-layer-molv&#x27;,</span></span></span><br><span class="line"><span class="language-javascript">									<span class="comment">//btn: [&#x27;修改&#x27;, &#x27;取消&#x27;],  //prompt中，不能随意改按钮标题</span></span></span><br><span class="line"><span class="language-javascript">								&#125;, </span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">function</span>(<span class="params">value, index, elem</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">if</span>(value === <span class="string">&#x27;&#x27;</span>) <span class="keyword">return</span> elem.<span class="title function_">focus</span>();</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">var</span> regex = <span class="regexp">/.*^[^?v\*|&quot;&quot;&lt;&gt;:,/]&#123;1,256&#125;$.*/</span>;</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">if</span>(regex.<span class="title function_">test</span>(value)==<span class="literal">false</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">										layer.<span class="title function_">tips</span>(<span class="string">&#x27;含有不合法的字符&#x27;</span>, elem);</span></span><br><span class="line"><span class="language-javascript">										elem.<span class="title function_">select</span>().<span class="title function_">focus</span>();	</span></span><br><span class="line"><span class="language-javascript">										<span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">									&#125;</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">if</span>(data.<span class="property">type</span>==<span class="number">0</span>)&#123;<span class="comment">//文件名后缀补齐</span></span></span><br><span class="line"><span class="language-javascript">										<span class="keyword">var</span> ext = data.<span class="property">name</span>.<span class="title function_">substring</span>(data.<span class="property">name</span>.<span class="title function_">lastIndexOf</span>(<span class="string">&quot;.&quot;</span>)); <span class="comment">//.txt</span></span></span><br><span class="line"><span class="language-javascript">										<span class="keyword">if</span>( value.<span class="title function_">split</span>(<span class="string">&quot;.&quot;</span>).<span class="property">length</span> &lt; <span class="number">2</span> )&#123;</span></span><br><span class="line"><span class="language-javascript">											value += ext;</span></span><br><span class="line"><span class="language-javascript">										&#125;;</span></span><br><span class="line"><span class="language-javascript">									&#125;</span></span><br><span class="line"><span class="language-javascript">									$.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">url</span>:<span class="string">&quot;rename&quot;</span> ,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">type</span>:<span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">data</span>:&#123;<span class="attr">path</span>:data.<span class="property">path</span>,<span class="attr">newname</span>:value&#125;,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">success</span>:<span class="keyword">function</span>(<span class="params">data</span>)&#123;	</span></span><br><span class="line"><span class="language-javascript">										  obj.<span class="title function_">update</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">											<span class="attr">name</span>: value,</span></span><br><span class="line"><span class="language-javascript">										  &#125;)</span></span><br><span class="line"><span class="language-javascript">										&#125;,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">error</span>:<span class="keyword">function</span>(<span class="params">xhr,errorText,errorType</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">											layer.<span class="title function_">msg</span>(<span class="string">&quot;重命名服务器文件失败&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">										&#125;							</span></span><br><span class="line"><span class="language-javascript">									&#125;); </span></span><br><span class="line"><span class="language-javascript">									<span class="comment">// 关闭 prompt</span></span></span><br><span class="line"><span class="language-javascript">									layer.<span class="title function_">close</span>(index);</span></span><br><span class="line"><span class="language-javascript">								&#125;</span></span><br><span class="line"><span class="language-javascript">							);</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">						<span class="keyword">case</span> <span class="string">&#x27;delete&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">							layer.<span class="title function_">confirm</span>(  data.<span class="property">type</span>==<span class="number">1</span>?<span class="string">&#x27;真的要删除这个目录吗?&#x27;</span>:<span class="string">&#x27;真的要删除这个文件吗?&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">title</span>: <span class="string">&#x27;确认信息&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">icon</span>: <span class="number">3</span>,</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">skin</span>: <span class="string">&#x27;class-layer-Warning&#x27;</span>,  <span class="comment">//自定义样式</span></span></span><br><span class="line"><span class="language-javascript">									<span class="attr">css</span>:  <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">								&#125;, </span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">function</span> (<span class="params">index</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">									$.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">url</span>:<span class="string">&quot;delete&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">type</span>:<span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">data</span>:&#123;<span class="attr">path</span>:data.<span class="property">path</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">success</span>:<span class="keyword">function</span>(<span class="params">data</span>)&#123;	</span></span><br><span class="line"><span class="language-javascript">											obj.<span class="title function_">del</span>();  <span class="comment">//删除当前表格一行记录</span></span></span><br><span class="line"><span class="language-javascript">											layer.<span class="title function_">msg</span>(<span class="string">&#x27;删除成功&#x27;</span>,&#123;<span class="attr">icon</span>:<span class="number">1</span>&#125;);</span></span><br><span class="line"><span class="language-javascript">										&#125;,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">error</span>:<span class="keyword">function</span>(<span class="params">xhr,errorText,errorType</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">											layer.<span class="title function_">msg</span>(<span class="string">&quot;删除服务器文件失败&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">										&#125;							</span></span><br><span class="line"><span class="language-javascript">									&#125;); </span></span><br><span class="line"><span class="language-javascript">									<span class="comment">// 关闭 prompt</span></span></span><br><span class="line"><span class="language-javascript">									layer.<span class="title function_">close</span>(index);</span></span><br><span class="line"><span class="language-javascript">								&#125;</span></span><br><span class="line"><span class="language-javascript">							);</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">					&#125;;</span></span><br><span class="line"><span class="language-javascript">				&#125;);</span></span><br><span class="line"><span class="language-javascript">				</span></span><br><span class="line"><span class="language-javascript">				<span class="comment">// 头工具栏-按钮事件</span></span></span><br><span class="line"><span class="language-javascript">				table.<span class="title function_">on</span>(<span class="string">&#x27;toolbar(table-file-list)&#x27;</span>, <span class="keyword">function</span>(<span class="params">obj</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">switch</span> (obj.<span class="property">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">						<span class="keyword">case</span> <span class="string">&#x27;createDir&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">var</span> curdir = <span class="title function_">lay</span>(<span class="string">&quot;#currDir&quot;</span>).<span class="title function_">html</span>(); <span class="comment">// 获取选中行数据</span></span></span><br><span class="line"><span class="language-javascript">							layer.<span class="title function_">prompt</span>(</span></span><br><span class="line"><span class="language-javascript">								&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">title</span>:  <span class="string">&#x27;请输入新建目录的名字&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">									<span class="attr">formType</span>: <span class="number">0</span>, </span></span><br><span class="line"><span class="language-javascript">								&#125;, </span></span><br><span class="line"><span class="language-javascript">								<span class="keyword">function</span>(<span class="params">value, index, elem</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">if</span>(value === <span class="string">&#x27;&#x27;</span>) <span class="keyword">return</span> elem.<span class="title function_">focus</span>();</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">var</span> regex = <span class="regexp">/.*^[^?v\*|&quot;&quot;&lt;&gt;:,/]&#123;1,256&#125;$.*/</span>;</span></span><br><span class="line"><span class="language-javascript">									<span class="keyword">if</span>(regex.<span class="title function_">test</span>(value)==<span class="literal">false</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">										layer.<span class="title function_">tips</span>(<span class="string">&#x27;含有不合法的字符&#x27;</span>, elem);</span></span><br><span class="line"><span class="language-javascript">										elem.<span class="title function_">select</span>().<span class="title function_">focus</span>();	</span></span><br><span class="line"><span class="language-javascript">										<span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">									&#125;</span></span><br><span class="line"><span class="language-javascript">									$.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">url</span>:<span class="string">&quot;createfolder&quot;</span> ,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">type</span>:<span class="string">&quot;post&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">data</span>:&#123;<span class="attr">fatherdir</span>:curdir,<span class="attr">foldername</span>:value&#125;,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">success</span>:<span class="keyword">function</span>(<span class="params">data</span>)&#123;	</span></span><br><span class="line"><span class="language-javascript">											<span class="comment">//获取浏览器本地缓存的表格data</span></span></span><br><span class="line"><span class="language-javascript">											<span class="keyword">var</span> oldDatas = layui.<span class="property">table</span>.<span class="property">cache</span>[<span class="string">&#x27;filelist&#x27;</span>];</span></span><br><span class="line"><span class="language-javascript">											<span class="keyword">var</span> newData = &#123;</span></span><br><span class="line"><span class="language-javascript">											                name : value,</span></span><br><span class="line"><span class="language-javascript">															size : <span class="string">&#x27;/&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">															time : (<span class="keyword">new</span> <span class="title class_">Date</span>()).<span class="title function_">toLocaleString</span>(<span class="string">&#x27;zh&#x27;</span>, &#123; <span class="attr">hour12</span>: <span class="literal">false</span> &#125;), <span class="comment">//北京时间</span></span></span><br><span class="line"><span class="language-javascript">															path : curdir + <span class="string">&#x27;/&#x27;</span> + value,</span></span><br><span class="line"><span class="language-javascript">															type : <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">											&#125;;</span></span><br><span class="line"><span class="language-javascript">											<span class="comment">//更新浏览器本地缓存的表格data</span></span></span><br><span class="line"><span class="language-javascript">											oldDatas.<span class="title function_">push</span>(newData);</span></span><br><span class="line"><span class="language-javascript">											table.<span class="title function_">reloadData</span>(<span class="string">&#x27;filelist&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">												data : oldDatas,</span></span><br><span class="line"><span class="language-javascript">											&#125;)</span></span><br><span class="line"><span class="language-javascript">											layer.<span class="title function_">msg</span>(<span class="string">&quot;目录: &quot;</span> + value +<span class="string">&quot; 已创建&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">										&#125;,</span></span><br><span class="line"><span class="language-javascript">										<span class="attr">error</span>:<span class="keyword">function</span>(<span class="params">xhr,errorText,errorType</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">											layer.<span class="title function_">msg</span>(<span class="string">&quot;创建目录失败&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">										&#125;							</span></span><br><span class="line"><span class="language-javascript">									&#125;); </span></span><br><span class="line"><span class="language-javascript">									<span class="comment">// 关闭 prompt</span></span></span><br><span class="line"><span class="language-javascript">									layer.<span class="title function_">close</span>(index);</span></span><br><span class="line"><span class="language-javascript">								&#125;</span></span><br><span class="line"><span class="language-javascript">							);</span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">						<span class="keyword">case</span> <span class="string">&#x27;updateFlie&#x27;</span>:</span></span><br><span class="line"><span class="language-javascript">							<span class="comment">//</span></span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">break</span>;</span></span><br><span class="line"><span class="language-javascript">					&#125;;</span></span><br><span class="line"><span class="language-javascript">				&#125;);				</span></span><br><span class="line"><span class="language-javascript">				<span class="comment">// 输入框点缀事件 - 搜索示例</span></span></span><br><span class="line"><span class="language-javascript">				form.<span class="title function_">on</span>(<span class="string">&#x27;input-affix(search)&#x27;</span>, <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">var</span> elem = data.<span class="property">elem</span>; <span class="comment">// 输入框</span></span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">var</span> value = elem.<span class="property">value</span>.<span class="title function_">trim</span>(); <span class="comment">// 输入框的值</span></span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">if</span> (!value) &#123;</span></span><br><span class="line"><span class="language-javascript">						layer.<span class="title function_">msg</span>(<span class="string">&#x27;请输入搜索内容&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">						<span class="keyword">return</span> elem.<span class="title function_">focus</span>()</span></span><br><span class="line"><span class="language-javascript">					&#125;;</span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">var</span> lastpath = $(<span class="string">&quot;#currDir&quot;</span>).<span class="title function_">html</span>();</span></span><br><span class="line"><span class="language-javascript">					<span class="keyword">if</span>(lastpath==<span class="string">&quot;&quot;</span>)&#123;lastpath = <span class="string">&quot;/&quot;</span>;&#125;</span></span><br><span class="line"><span class="language-javascript">					<span class="comment">// </span></span></span><br><span class="line"><span class="language-javascript">					table.<span class="title function_">reloadData</span>(<span class="string">&#x27;filelist&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">						<span class="attr">url</span>: <span class="string">&#x27;/search?keywords=&#x27;</span> + value, <span class="comment">// 搜索接口</span></span></span><br><span class="line"><span class="language-javascript">						<span class="attr">done</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">							<span class="comment">//修改面包屑</span></span></span><br><span class="line"><span class="language-javascript">							<span class="keyword">var</span> lst = <span class="string">&#x27;&lt;a href=&quot;/?folderpath=&#x27;</span> + lastpath + <span class="string">&#x27;&quot;&gt;返回上一页&lt;/a&gt;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">							lst += <span class="string">&#x27;&lt;a&gt;&lt;cite&gt;搜索结果&lt;/cite&gt;&lt;/a&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">							<span class="title function_">lay</span>(<span class="string">&quot;#breadcrumb&quot;</span>).<span class="title function_">html</span>( lst );</span></span><br><span class="line"><span class="language-javascript">							</span></span><br><span class="line"><span class="language-javascript">							<span class="comment">// 渲染面包屑组件</span></span></span><br><span class="line"><span class="language-javascript">							element.<span class="title function_">render</span>(<span class="string">&#x27;breadcrumb&#x27;</span>, <span class="string">&#x27;breadcrumb-bar&#x27;</span>);  </span></span><br><span class="line"><span class="language-javascript">						&#125;</span></span><br><span class="line"><span class="language-javascript">					&#125;);					</span></span><br><span class="line"><span class="language-javascript">				&#125;);</span></span><br><span class="line"><span class="language-javascript">			&#125;);</span></span><br><span class="line"><span class="language-javascript">		</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>上面这个web页面，根据自己的需求自己改改。</p>
<p>自己打包编译一下，做个单文件exe，还是不错的。</p>
<p>不过还能改进，就是把localhost改成局域网ip，端口做个自定义。</p>
<p>美滋滋。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://zhuzhuhawk.github.io/2024/12/25/use-aardio-make-a-simplehttpserver-tool/" data-id="cm53arg8n00036kgv1zdi8ax2" data-title="使用aardio制作一个简单的httpserver工具网页版" class="article-share-link"><span class="fa fa-share">分享</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/aardio/" rel="tag">aardio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/httpserver/" rel="tag">httpserver</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/webtool/" rel="tag">webtool</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2024/11/27/win10-ime-setting/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">win10微软拼音输入法卡顿整理</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/aardio/" rel="tag">aardio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/httpserver/" rel="tag">httpserver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webtool/" rel="tag">webtool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win10/" rel="tag">win10</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%A8%E5%B1%8Bwifi/" rel="tag">全屋wifi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%91%A8%E4%B8%80/" rel="tag">周一</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E8%BD%AF%E6%8B%BC%E9%9F%B3/" rel="tag">微软拼音</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8B%94%E7%89%99/" rel="tag">拔牙</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%99%B4%E5%A4%A9/" rel="tag">晴天</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%99%BA%E8%83%BD%E5%AE%B6%E5%B1%85/" rel="tag">智能家居</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%99%E9%BD%BF/" rel="tag">牙齿</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BE%93%E5%85%A5%E6%B3%95/" rel="tag">输入法</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/aardio/" style="font-size: 10px;">aardio</a> <a href="/tags/httpserver/" style="font-size: 10px;">httpserver</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/webtool/" style="font-size: 10px;">webtool</a> <a href="/tags/win10/" style="font-size: 10px;">win10</a> <a href="/tags/%E5%85%A8%E5%B1%8Bwifi/" style="font-size: 10px;">全屋wifi</a> <a href="/tags/%E5%91%A8%E4%B8%80/" style="font-size: 10px;">周一</a> <a href="/tags/%E5%BE%AE%E8%BD%AF%E6%8B%BC%E9%9F%B3/" style="font-size: 10px;">微软拼音</a> <a href="/tags/%E6%8B%94%E7%89%99/" style="font-size: 10px;">拔牙</a> <a href="/tags/%E6%99%B4%E5%A4%A9/" style="font-size: 10px;">晴天</a> <a href="/tags/%E6%99%BA%E8%83%BD%E5%AE%B6%E5%B1%85/" style="font-size: 10px;">智能家居</a> <a href="/tags/%E7%89%99%E9%BD%BF/" style="font-size: 20px;">牙齿</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 10px;">网络</a> <a href="/tags/%E8%BE%93%E5%85%A5%E6%B3%95/" style="font-size: 10px;">输入法</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">十二月 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/11/">十一月 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/12/25/use-aardio-make-a-simplehttpserver-tool/">使用aardio制作一个简单的httpserver工具网页版</a>
          </li>
        
          <li>
            <a href="/2024/11/27/win10-ime-setting/">win10微软拼音输入法卡顿整理</a>
          </li>
        
          <li>
            <a href="/2024/11/12/house-add-network/">房屋网络覆盖事项</a>
          </li>
        
          <li>
            <a href="/2024/11/08/%E6%8B%94%E7%89%99%E8%AE%B0/">拔牙记</a>
          </li>
        
          <li>
            <a href="/2024/11/08/%E7%AB%8B%E5%86%AC%E5%90%8E%E7%9A%84%E7%AC%AC%E4%B8%80%E5%A4%A9/">立冬后的第一天</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 小蓝<br>     
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/categories" class="mobile-nav-link">分类</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>